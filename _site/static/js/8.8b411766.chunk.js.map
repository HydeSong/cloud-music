{"version":3,"sources":["application/Singers/style.js","application/Rank/style.js","application/Rank/index.js","api/utils.js","baseUI/loading/index.js","baseUI/loading-v2/index.js","baseUI/scroll/index.js"],"names":["NavContainer","styled","div","_templateObject","_taggedTemplateLiteral","ListContainer","_templateObject2","List","_templateObject3","style","ListItem","_templateObject4","EnterLoading","_templateObject5","Container","ul","props","globalRank","li","tracks","length","SongList","connect","state","rankList","getIn","loading","dispatch","getRankListDataDispatch","getRankList","React","memo","list","toJS","useEffect","globalStartIndex","filterIndex","officialList","slice","globalList","renderRankList","global","createElement","map","item","index","key","coverImgId","onClick","detail","history","push","concat","id","className","src","coverImgUrl","alt","updateFrequency","first","second","renderSongList","displayStyle","display","Scroll","Loading","renderRoutes","route","routes","getCount","count","Math","floor","debounce","func","delay","timer","_this","_len","arguments","args","Array","_key","clearTimeout","setTimeout","apply","i","getName","str","name","isEmptyObject","obj","Object","keys","keyframes","LoadingWrapper","show","defaultProps","dance","ScrollContainer","PullUpLoading","PullDownLoading","forwardRef","ref","_useState","useState","_useState2","_slicedToArray","bScroll","setBScroll","scrollContaninerRef","useRef","direction","click","refresh","bounceTop","bounceBottom","pullUp","pullDown","onScroll","pullUpLoading","pullDownLoading","pullUpDebounce","useMemo","pullDownDebounce","scroll","BScroll","current","scrollX","scrollY","probeType","bounce","top","bottom","on","off","y","maxScrollY","pos","useImperativeHandle","scrollTo","getBScroll","PullUpdisplayStyle","PullDowndisplayStyle","children","LoadingV2"],"mappings":"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","file":"static/js/8.8b411766.chunk.js","sourcesContent":["import styled from 'styled-components';\r\nimport style from '../../assets/global-style';\r\n\r\nexport const NavContainer = styled.div`\r\n  box-sizing: border-box;\r\n  position: fixed;\r\n  top: 95px;\r\n  width: 100%;\r\n  padding: 5px;\r\n  overflow: hidden;\r\n`;\r\n\r\nexport const ListContainer = styled.div`\r\n  position: fixed;\r\n  top: 160px;\r\n  left: 0;\r\n  bottom: 0;\r\n  overflow: hidden;\r\n  width: 100%;\r\n`;\r\n\r\nexport const List = styled.div`\r\n  display: flex;\r\n  margin: auto;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n  .title {\r\n    margin:10px 0 10px 10px;\r\n    color: ${style['font-color-desc']};\r\n    font-size: ${style['font-size-s']};\r\n  }\r\n`;\r\nexport const ListItem = styled.div`\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: 0 5px;\r\n  padding: 5px 0;\r\n  align-items: center;\r\n  border-bottom: 1px solid ${style['border-color']};\r\n  .img_wrapper {\r\n    margin-right: 20px;\r\n    img {\r\n      border-radius: 3px;\r\n      width: 50px;\r\n      height: 50px;\r\n    }\r\n  }\r\n  .name {\r\n    font-size: ${style['font-size-m']};\r\n    color: ${style['font-color-desc']};\r\n    font-weight: 500;\r\n  }\r\n`;\r\nexport const EnterLoading = styled.div`\r\n  position: fixed;\r\n  left: 0; right: 0; top: 0; bottom: 0;\r\n  width: 100px;\r\n  height: 100px;\r\n  margin: auto;\r\n`;\r\n\r\n","import styled from 'styled-components';\r\nimport style from '../../assets/global-style';\r\n\r\n// Props中的globalRank和tracks.length均代表是否为全球榜\r\n\r\nexport const Container = styled.div`\r\n  position: fixed;\r\n  top: 90px;\r\n  bottom: 0;\r\n  width: 100%;\r\n  .offical,.global {\r\n    margin: 10px 5px;\r\n    padding-top: 15px;\r\n    font-weight: 700;\r\n    font-size: ${style['font-size-m']};\r\n    color: ${style['font-color-desc']};\r\n  }\r\n`;\r\nexport const List = styled.ul`\r\n  margin-top: 10px;\r\n  padding: 0 5px;\r\n  display: ${props => (props.globalRank ? 'flex' : '')};\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  flex-wrap: wrap;\r\n  background: ${style['background-color']};\r\n  &::after{\r\n    content:\"\";\r\n    display:block;\r\n    width: 32vw;\r\n  }\r\n`;\r\nexport const ListItem = styled.li`\r\n  display: ${props => (props.tracks.length ? 'flex' : '')};\r\n  padding: 3px 0;\r\n  border-bottom: 1px solid ${style['border-color']};\r\n  .img_wrapper{\r\n    width:  ${props => (props.tracks.length ? '27vw' : '32vw')};\r\n    height: ${props => (props.tracks.length ? '27vw' : '32vw')};\r\n    border-radius: 3px;\r\n    position: relative;\r\n    .decorate {\r\n      position: absolute;\r\n      bottom: 0;\r\n      width: 100%;\r\n      height: 35px;\r\n      border-radius: 3px;\r\n      background: linear-gradient(hsla(0,0%,100%,0),hsla(0,0%,43%,.4));\r\n    }\r\n    img{\r\n      width: 100%;\r\n      height: 100%;\r\n      border-radius: 3px;\r\n    }\r\n    .update_frequecy{\r\n      position: absolute;\r\n      left: 7px;\r\n      bottom: 7px;\r\n      font-size: ${style['font-size-ss']};\r\n      color: ${style['font-color-light']};\r\n    }\r\n  }\r\n`;\r\nexport const SongList = styled.ul`\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-around;\r\n  padding: 10px 10px;\r\n  >li{\r\n    font-size: ${style['font-size-s']};\r\n    color: grey;\r\n  }\r\n`;\r\n","import React, {useEffect} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {getRankList} from './store/index';\r\nimport Loading from '../../baseUI/loading';\r\nimport {List, ListItem, SongList, Container} from './style';\r\nimport Scroll from '../../baseUI/scroll/index';\r\nimport {EnterLoading} from './../Singers/style';\r\nimport {filterIndex} from '../../api/utils';\r\nimport {renderRoutes} from 'react-router-config';\r\n\r\nfunction Rank (props) {\r\n  const {rankList: list, loading} = props;\r\n\r\n  const {getRankListDataDispatch} = props;\r\n\r\n  let rankList = list ? list.toJS () : [];\r\n\r\n  useEffect (() => {\r\n    if (!rankList.length) {\r\n      getRankListDataDispatch ();\r\n    }\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  let globalStartIndex = filterIndex (rankList);\r\n  let officialList = rankList.slice (0, globalStartIndex);\r\n  let globalList = rankList.slice (globalStartIndex);\r\n\r\n  const enterDetail = detail => {\r\n    props.history.push (`/rank/${detail.id}`);\r\n  };\r\n  const renderSongList = list => {\r\n    return list.length\r\n      ? <SongList>\r\n          {list.map ((item, index) => {\r\n            return (\r\n              <li key={index}>{index + 1}. {item.first} - {item.second}</li>\r\n            );\r\n          })}\r\n        </SongList>\r\n      : null;\r\n  };\r\n  const renderRankList = (list, global) => {\r\n    return (\r\n      <List globalRank={global}>\r\n        {list.map ((item, index) => {\r\n          return (\r\n            <ListItem\r\n              key={item.coverImgId + \"\" + index}\r\n              tracks={item.tracks}\r\n              onClick={() => enterDetail (item)}\r\n            >\r\n              <div className=\"img_wrapper\">\r\n                <img src={item.coverImgUrl} alt=\"\" />\r\n                <div className=\"decorate\" />\r\n                <span className=\"update_frequecy\">{item.updateFrequency}</span>\r\n              </div>\r\n              {renderSongList (item.tracks)}\r\n            </ListItem>\r\n          );\r\n        })}\r\n      </List>\r\n    );\r\n  };\r\n\r\n  let displayStyle = loading ? {display: 'none'} : {display: ''};\r\n  return (\r\n    <Container>\r\n      <Scroll>\r\n        <div>\r\n          <h1 className=\"offical\" style={displayStyle}>官方榜</h1>\r\n          {renderRankList (officialList)}\r\n          <h1 className=\"global\" style={displayStyle}>全球榜</h1>\r\n          {renderRankList (globalList, true)}\r\n          {loading ? <EnterLoading><Loading /></EnterLoading> : null}\r\n        </div>\r\n      </Scroll>\r\n      {renderRoutes (props.route.routes)}\r\n    </Container>\r\n  );\r\n}\r\n\r\n// 映射Redux全局的state到组件的props上\r\nconst mapStateToProps = state => ({\r\n  rankList: state.getIn (['rank', 'rankList']),\r\n  loading: state.getIn (['rank', 'loading']),\r\n});\r\n// 映射dispatch到props上\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    getRankListDataDispatch () {\r\n      dispatch (getRankList ());\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect (mapStateToProps, mapDispatchToProps) (\r\n  React.memo (Rank)\r\n);\r\n","import {RankTypes} from './config';\r\n\r\nexport const getCount = count => {\r\n  if (count < 0) return;\r\n  if (count < 10000) {\r\n    return count;\r\n  } else if (Math.floor (count / 10000) < 10000) {\r\n    return Math.floor (count / 1000) / 10 + '万';\r\n  } else {\r\n    return Math.floor (count / 10000000) / 10 + '亿';\r\n  }\r\n};\r\n\r\nexport const debounce = (func, delay) => {\r\n  let timer;\r\n  return function (...args) {\r\n    if (timer) {\r\n      clearTimeout (timer);\r\n    }\r\n    timer = setTimeout (() => {\r\n      func.apply (this, args);\r\n      clearTimeout (timer);\r\n    }, delay);\r\n  };\r\n};\r\n\r\n// 处理数据，找出第一个没有歌名的排行榜的索引\r\nexport const filterIndex = rankList => {\r\n  for (let i = 0; i < rankList.length - 1; i++) {\r\n    if (rankList[i].tracks.length && !rankList[i + 1].tracks.length) {\r\n      return i + 1;\r\n    }\r\n  }\r\n};\r\n\r\n//找出排行榜的编号\r\nexport const filterIdx = name => {\r\n  for (var key in RankTypes) {\r\n    if (RankTypes[key] === name) return key;\r\n  }\r\n  return null;\r\n};\r\n\r\n// 处理歌手列表拼接歌手名字\r\nexport const getName = list => {\r\n  let str = '';\r\n  list.map ((item, index) => {\r\n    str += index === 0 ? item.name : '/' + item.name;\r\n    return item;\r\n  });\r\n  return str;\r\n};\r\n\r\n//判断一个对象是否为空\r\nexport const isEmptyObject = obj => !obj || Object.keys (obj).length === 0;\r\n","import React from 'react';\r\nimport styled, {keyframes} from 'styled-components';\r\nimport style from '../../assets/global-style';\r\nimport {PropTypes} from 'prop-types';\r\n\r\nconst loading = keyframes`\r\n  0%, 100% {\r\n    transform: scale(0.0);\r\n  }\r\n  50% {\r\n    transform: scale(1.0);\r\n  }\r\n`;\r\nconst LoadingWrapper = styled.div`\r\n  >div {\r\n    position: absolute;\r\n    left: 0; \r\n    right: 0;  \r\n    top: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    width: 60px;\r\n    height: 60px;\r\n    opacity: 0.6;\r\n    border-radius: 50%;\r\n    background-color: ${style['theme-color']};\r\n    animation: ${loading} 1.4s infinite ease-in;\r\n  }\r\n  >div:nth-child(2) {\r\n    animation-delay: -0.7s;\r\n  }\r\n`;\r\n\r\nfunction Loading (props) {\r\n  const {show} = props;\r\n  return (\r\n    <LoadingWrapper style={show ? {display: ''} : {display: 'none'}}>\r\n      <div />\r\n      <div />\r\n    </LoadingWrapper>\r\n  );\r\n}\r\n\r\nLoading.defaultProps = {\r\n  show: true,\r\n};\r\n\r\nLoading.propTypes = {\r\n  show: PropTypes.bool,\r\n};\r\n\r\nexport default React.memo (Loading);\r\n","import React from 'react';\r\nimport styled, {keyframes} from 'styled-components';\r\nimport style from '../../assets/global-style';\r\n\r\nconst dance = keyframes`\r\n    0%, 40%, 100%{\r\n      transform: scaleY(0.4);\r\n      transform-origin: center 100%;\r\n    }\r\n    20%{\r\n      transform: scaleY(1);\r\n    }\r\n`;\r\nconst Loading = styled.div`\r\n    height: 10px;\r\n    width: 100%;\r\n    margin: auto;\r\n    text-align: center;\r\n    font-size: 10px;\r\n    >div{\r\n      display: inline-block;\r\n      background-color: ${style['theme-color']};\r\n      height: 100%;\r\n      width: 1px;\r\n      margin-right:2px;\r\n      animation: ${dance} 1s infinite;\r\n    }\r\n    >div:nth-child(2) {\r\n      animation-delay: -0.4s;\r\n    }\r\n    >div:nth-child(3) {\r\n      animation-delay: -0.6s;\r\n    }\r\n    >div:nth-child(4) {\r\n      animation-delay: -0.5s;\r\n    }\r\n    >div:nth-child(5) {\r\n      animation-delay: -0.2s;\r\n    } \r\n`;\r\n\r\nfunction LoadingV2 () {\r\n  return (\r\n    <Loading>\r\n      <div />\r\n      <div />\r\n      <div />\r\n      <div />\r\n      <div />\r\n      <span>拼命加载中...</span>\r\n    </Loading>\r\n  );\r\n}\r\n\r\nexport default React.memo (LoadingV2);\r\n","import React, {\r\n  forwardRef,\r\n  useState,\r\n  useEffect,\r\n  useRef,\r\n  useImperativeHandle,\r\n  useMemo,\r\n} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport BScroll from 'better-scroll';\r\nimport styled from 'styled-components';\r\nimport Loading from '../loading';\r\nimport {debounce} from '../../api/utils';\r\nimport LoadingV2 from '../loading-v2';\r\n\r\nconst ScrollContainer = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst PullUpLoading = styled.div`\r\n  position: absolute;\r\n  left:0; right:0;\r\n  bottom: 5px;\r\n  width: 60px;\r\n  height: 60px;\r\n  margin: auto;\r\n  z-index: 100;\r\n`;\r\n\r\nexport const PullDownLoading = styled.div`\r\n  position: absolute;\r\n  left:0; right:0;\r\n  top: 0px;\r\n  height: 30px;\r\n  margin: auto;\r\n  z-index: 100;\r\n`;\r\n\r\nconst Scroll = forwardRef ((props, ref) => {\r\n  const [bScroll, setBScroll] = useState ();\r\n\r\n  const scrollContaninerRef = useRef ();\r\n\r\n  const {direction, click, refresh, bounceTop, bounceBottom} = props;\r\n\r\n  const {pullUp, pullDown, onScroll, pullUpLoading, pullDownLoading} = props;\r\n\r\n  let pullUpDebounce = useMemo (\r\n    () => {\r\n      return debounce (pullUp, 300);\r\n    },\r\n    [pullUp]\r\n  );\r\n\r\n  let pullDownDebounce = useMemo (\r\n    () => {\r\n      return debounce (pullDown, 300);\r\n    },\r\n    [pullDown]\r\n  );\r\n\r\n  useEffect (() => {\r\n    const scroll = new BScroll (scrollContaninerRef.current, {\r\n      scrollX: direction === 'horizental',\r\n      scrollY: direction === 'vertical',\r\n      probeType: 3,\r\n      click: click,\r\n      bounce: {\r\n        top: bounceTop,\r\n        bottom: bounceBottom,\r\n      },\r\n    });\r\n    setBScroll (scroll);\r\n    return () => {\r\n      setBScroll (null);\r\n    };\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect (\r\n    () => {\r\n      if (!bScroll || !onScroll) return;\r\n      bScroll.on ('scroll', scroll => {\r\n        onScroll (scroll);\r\n      });\r\n      return () => {\r\n        bScroll.off ('scroll');\r\n      };\r\n    },\r\n    [onScroll, bScroll]\r\n  );\r\n\r\n  useEffect (\r\n    () => {\r\n      if (!bScroll || !pullUp) return;\r\n      bScroll.on ('scrollEnd', () => {\r\n        //判断是否滑动到了底部\r\n        if (bScroll.y <= bScroll.maxScrollY + 100) {\r\n          pullUpDebounce ();\r\n        }\r\n      });\r\n      return () => {\r\n        bScroll.off ('scrollEnd');\r\n      };\r\n    },\r\n    [pullUpDebounce, pullUp, bScroll]\r\n  );\r\n\r\n  useEffect (\r\n    () => {\r\n      if (!bScroll || !pullDown) return;\r\n      bScroll.on ('touchEnd', pos => {\r\n        //判断用户的下拉动作\r\n        if (pos.y > 50) {\r\n          pullDownDebounce ();\r\n        }\r\n      });\r\n      return () => {\r\n        bScroll.off ('touchEnd');\r\n      };\r\n    },\r\n    [pullDownDebounce, pullDown, bScroll]\r\n  );\r\n\r\n  useEffect (() => {\r\n    if (refresh && bScroll) {\r\n      bScroll.refresh ();\r\n    }\r\n  });\r\n\r\n  useImperativeHandle (ref, () => ({\r\n    refresh () {\r\n      if (bScroll) {\r\n        bScroll.refresh ();\r\n        bScroll.scrollTo (0, 0);\r\n      }\r\n    },\r\n    getBScroll () {\r\n      if (bScroll) {\r\n        return bScroll;\r\n      }\r\n    },\r\n  }));\r\n\r\n  const PullUpdisplayStyle = pullUpLoading ? {display: ''} : {display: 'none'};\r\n  const PullDowndisplayStyle = pullDownLoading ? {display: ''} : {display: 'none'};\r\n  return (\r\n    <ScrollContainer ref={scrollContaninerRef}>\r\n      {props.children}\r\n      {/* 滑到底部加载动画 */}\r\n      <PullUpLoading style={PullUpdisplayStyle}><Loading /></PullUpLoading>\r\n      {/* 顶部下拉刷新动画 */}\r\n      <PullDownLoading style={PullDowndisplayStyle}>\r\n        <LoadingV2 />\r\n      </PullDownLoading>\r\n    </ScrollContainer>\r\n  );\r\n});\r\n\r\nScroll.defaultProps = {\r\n  direction: 'vertical',\r\n  click: true,\r\n  refresh: true,\r\n  onScroll: null,\r\n  pullUpLoading: false,\r\n  pullDownLoading: false,\r\n  pullUp: null,\r\n  pullDown: null,\r\n  bounceTop: true,\r\n  bounceBottom: true,\r\n};\r\n\r\nScroll.propTypes = {\r\n  direction: PropTypes.oneOf (['vertical', 'horizental']),\r\n  refresh: PropTypes.bool,\r\n  onScroll: PropTypes.func,\r\n  pullUp: PropTypes.func,\r\n  pullDown: PropTypes.func,\r\n  pullUpLoading: PropTypes.bool,\r\n  pullDownLoading: PropTypes.bool,\r\n  bounceTop: PropTypes.bool, //是否支持向上吸顶\r\n  bounceBottom: PropTypes.bool, //是否支持向上吸顶\r\n};\r\n\r\nexport default Scroll;\r\n"],"sourceRoot":""}