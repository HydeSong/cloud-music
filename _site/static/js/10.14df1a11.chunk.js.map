{"version":3,"sources":["baseUI/header/index.js","application/Singer/style.js","application/SongsList/style.js","application/SongsList/index.js","application/Singer/index.js","api/utils.js","baseUI/loading/index.js","baseUI/loading-v2/index.js","baseUI/scroll/index.js"],"names":["HeaderContainer","styled","div","_templateObject","_taggedTemplateLiteral","style","Header","React","forwardRef","props","ref","handleClick","title","isMarquee","createElement","className","onClick","defaultProps","memo","Container","play","ImgWrapper","_templateObject2","bgUrl","CollectButton","_templateObject3","SongListWrapper","_templateObject4","BgLayer","_templateObject5","SongList","showBackground","concat","SongItem","ul","noWrap","SongsList","refs","count","collectCount","showCollect","songs","totalCount","length","selectItem","e","index","console","log","Math","floor","list","res","_loop","i","item","push","key","id","name","ar","getName","artists","al","album","songList","connect","state","artist","getIn","loading","dispatch","getSingerDataDispatch","changeEnterLoading","getSingerInfo","initialHeight","useRef","_useState","useState","_useState2","_slicedToArray","showStatus","setShowStatus","immutableArtist","immutableSongs","toJS","collectButton","imageWrapper","songScrollWrapper","songScroll","header","layer","useEffect","match","params","h","current","offsetHeight","top","refresh","handleScroll","useCallback","pos","height","newY","y","imageDOM","buttonDOM","headerDOM","layerDOM","minScrollY","HEADER_HEIGHT","percent","abs","zIndex","paddingTop","setShowStatusFalse","CSSTransition","in","timeout","classNames","appear","unmountOnExit","onExited","history","goBack","picUrl","Scroll","onScroll","Loading","getCount","debounce","func","delay","timer","_this","_len","arguments","args","Array","_key","clearTimeout","setTimeout","apply","filterIndex","rankList","tracks","str","map","isEmptyObject","obj","Object","keys","keyframes","LoadingWrapper","show","display","dance","ScrollContainer","PullUpLoading","PullDownLoading","bScroll","setBScroll","scrollContaninerRef","direction","click","bounceTop","bounceBottom","pullUp","pullDown","pullUpLoading","pullDownLoading","pullUpDebounce","useMemo","pullDownDebounce","scroll","BScroll","scrollX","scrollY","probeType","bounce","bottom","on","off","maxScrollY","useImperativeHandle","scrollTo","getBScroll","PullUpdisplayStyle","PullDowndisplayStyle","children","LoadingV2"],"mappings":"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","file":"static/js/10.14df1a11.chunk.js","sourcesContent":["import React from 'react';\r\nimport styled from 'styled-components';\r\nimport style from '../../assets/global-style';\r\nimport PropTypes from 'prop-types';\r\n\r\nconst HeaderContainer = styled.div`\r\n  position: fixed;\r\n  padding: 5px 10px;\r\n  padding-top: 0;\r\n  height: 40px;\r\n  width: 100%;\r\n  z-index: 100;\r\n  display: flex;\r\n  line-height: 40px;\r\n  color: ${style['font-color-light']};\r\n  .back{\r\n    margin-right: 5px;\r\n    font-size: 20px;\r\n    width: 20px;\r\n  }\r\n  >h1{\r\n    font-size: ${style['font-size-l']};\r\n    font-weight: 700;\r\n  }\r\n`;\r\n// 处理函数组件拿不到ref的问题,所以用forwardRef\r\nconst Header = React.forwardRef ((props, ref) => {\r\n  const {handleClick, title, isMarquee} = props;\r\n  return (\r\n    <HeaderContainer ref={ref}>\r\n      <i className=\"iconfont back\" onClick={handleClick}>&#xe655;</i>\r\n      {// eslint-disable-next-line\r\n      isMarquee ? <marquee><h1>{title}</h1></marquee> : <h1>{title}</h1>}\r\n    </HeaderContainer>\r\n  );\r\n});\r\n\r\nHeader.defaultProps = {\r\n  handleClick: () => {},\r\n  title: '标题',\r\n  isMarquee: false,\r\n};\r\n\r\nHeader.propTypes = {\r\n  handleClick: PropTypes.func,\r\n  title: PropTypes.string,\r\n  isMarquee: PropTypes.bool,\r\n};\r\n\r\nexport default React.memo (Header);\r\n","import styled from 'styled-components';\r\nimport style from '../../assets/global-style';\r\n\r\nexport const Container = styled.div`\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: ${props => (props.play > 0 ? '60px' : 0)};\r\n  width: 100%;\r\n  z-index: 100;\r\n  overflow: hidden;\r\n  background: #f2f3f4;\r\n  transform-origin: right bottom;\r\n  &.fly-enter, &.fly-appear{\r\n    transform: rotateZ(30deg) translate3d(100%, 0, 0);\r\n  }\r\n  &.fly-enter-active, &.fly-appear-active{\r\n    transition: transform .3s;\r\n    transform: rotateZ(0deg) translate3d(0, 0, 0);\r\n  }\r\n  &.fly-exit{\r\n    transform: rotateZ(0deg) translate3d(0, 0, 0);\r\n  }\r\n  &.fly-exit-active{\r\n    transition: transform .3s;\r\n    transform: rotateZ(30deg) translate3d(100%, 0, 0);\r\n  }\r\n`;\r\nexport const ImgWrapper = styled.div`\r\n  position: relative;\r\n  width: 100%;\r\n  height: 0;\r\n  padding-top: 75%;\r\n  transform-origin: top;\r\n  background: url(${props => props.bgUrl});\r\n  background-size: cover;\r\n  z-index: 50;\r\n  .filter {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: rgba(7, 17, 27, 0.3);\r\n  }\r\n`;\r\n\r\nexport const CollectButton = styled.div`\r\n  position: absolute;\r\n  left: 0; right: 0;\r\n  margin: auto;\r\n  box-sizing: border-box;\r\n  width: 120px;\r\n  height: 40px;\r\n  margin-top: -55px;\r\n  z-index:50;\r\n  background: ${style['theme-color']};\r\n  color: ${style['font-color-light']};\r\n  border-radius: 20px;\r\n  text-align: center;\r\n  font-size: 0;\r\n  line-height: 40px;\r\n  .iconfont{\r\n    display: inline-block;\r\n    margin-right: 10px;\r\n    font-size: 12px;\r\n    vertical-align: 1px;\r\n  }\r\n  .text {\r\n    display: inline-block;\r\n    font-size:14px;\r\n    letter-spacing: 5px;\r\n  }\r\n`;\r\n\r\nexport const SongListWrapper = styled.div`\r\n  position: absolute;\r\n  z-index: 50;\r\n  top: 0;\r\n  left: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  >div{\r\n    position: absolute;\r\n    left: 0;\r\n    width: 100%;\r\n    overflow: visible;\r\n  }\r\n`;\r\n\r\nexport const BgLayer = styled.div`\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  width: 100%;\r\n  background: white;\r\n  border-radius: 10px;\r\n  z-index: 50;\r\n`;\r\n","import styled from 'styled-components';\r\nimport style from '../../assets/global-style';\r\n\r\nexport const SongList = styled.div`\r\n  border-radius: 10px;\r\n  opacity: 0.98;\r\n  ${props => (props.showBackground ? `background: ${style['highlight-background-color']}` : '')}\r\n  .first_line{\r\n    box-sizing: border-box;\r\n    padding: 10px 0;\r\n    margin-left: 10px;\r\n    position: relative;\r\n    justify-content: space-between;\r\n    border-bottom: 1px solid ${style['border-color']};\r\n    .play_all{\r\n      display: inline-block;\r\n      line-height: 24px;\r\n      color: ${style['font-color-desc']};\r\n      .iconfont {\r\n        font-size: 24px;\r\n        margin-right: 10px;\r\n        vertical-align: top;\r\n      }\r\n      .sum{\r\n        font-size: ${style['font-size-s']};\r\n        color: ${style['font-color-desc-v2']};\r\n      }\r\n      >span{\r\n        vertical-align: top;\r\n      }\r\n    }\r\n    .add_list,.isCollected {\r\n      display: flex;\r\n      align-items: center;\r\n      position: absolute;\r\n      right: 0; top :0; bottom: 0;\r\n      width: 130px;\r\n      line-height: 34px;\r\n      background: ${style['theme-color']};\r\n      color: ${style['font-color-light']};\r\n      font-size: 0;\r\n      border-radius: 3px;\r\n      vertical-align: top;\r\n      .iconfont {\r\n        vertical-align: top;\r\n        font-size: 10px;\r\n        margin: 0 5px 0 10px;\r\n      }\r\n      span{\r\n        font-size: 14px;\r\n        line-height: 34px;\r\n      }\r\n    }\r\n    .isCollected{\r\n      display: flex;\r\n      background: ${style['background-color']};\r\n      color: ${style['font-color-desc']};\r\n    }\r\n}\r\n`;\r\nexport const SongItem = styled.ul`\r\n  >li{\r\n    display: flex;\r\n    height: 60px;\r\n    align-items: center;  \r\n    .index{\r\n      flex-basis: 60px;\r\n      width: 60px;\r\n      height: 60px;\r\n      line-height: 60px;\r\n      text-align: center;\r\n    }\r\n    .info{\r\n      box-sizing: border-box;\r\n      flex: 1;\r\n      display: flex;\r\n      height: 100%;\r\n      padding: 5px 0;\r\n      flex-direction: column;\r\n      justify-content: space-around;\r\n      border-bottom: 1px solid ${style['border-color']};\r\n      ${style.noWrap ()}\r\n      >span{\r\n        ${style.noWrap ()}\r\n      }\r\n      >span:first-child{\r\n        color: ${style['font-color-desc']};\r\n      }\r\n      >span:last-child{\r\n        font-size: ${style['font-size-s']};\r\n        color: #bba8a8;\r\n      }\r\n    }\r\n  }\r\n`;\r\n","import React from 'react';\r\nimport {SongList, SongItem} from './style';\r\nimport {getName} from '../../api/utils';\r\n\r\nconst SongsList = React.forwardRef ((props, refs) => {\r\n  const {collectCount, showCollect, songs} = props;\r\n\r\n  const totalCount = songs.length;\r\n\r\n  const selectItem = (e, index) => {\r\n    console.log (index);\r\n  };\r\n\r\n  let songList = list => {\r\n    let res = [];\r\n    for (let i = 0; i < list.length; i++) {\r\n      let item = list[i];\r\n      res.push (\r\n        <li key={item.id} onClick={e => selectItem (e, i)}>\r\n          <span className=\"index\">{i + 1}</span>\r\n          <div className=\"info\">\r\n            <span>{item.name}</span>\r\n            <span>\r\n              {item.ar ? getName (item.ar) : getName (item.artists)}\r\n              {' '}\r\n              -\r\n              {' '}\r\n              {item.al ? item.al.name : item.album.name}\r\n            </span>\r\n          </div>\r\n        </li>\r\n      );\r\n    }\r\n    return res;\r\n  };\r\n\r\n  const collect = count => {\r\n    return (\r\n      <div className=\"add_list\">\r\n        <i className=\"iconfont\">&#xe62d;</i>\r\n        <span>收藏({Math.floor (count / 1000) / 10}万)</span>\r\n      </div>\r\n    );\r\n    // <div className=\"isCollected\">\r\n    //   <span>已收藏({Math.floor(count/1000)/10}万)</span>\r\n    // </div>\r\n  };\r\n  return (\r\n    <SongList ref={refs} showBackground={props.showBackground}>\r\n      <div className=\"first_line\">\r\n        <div className=\"play_all\" onClick={e => selectItem (e, 0)}>\r\n          <i className=\"iconfont\">&#xe6e3;</i>\r\n          <span>播放全部 <span className=\"sum\">(共{totalCount}首)</span></span>\r\n        </div>\r\n        {showCollect ? collect (collectCount) : null}\r\n      </div>\r\n      <SongItem>\r\n        {songList (songs)}\r\n      </SongItem>\r\n    </SongList>\r\n  );\r\n});\r\n\r\nexport default React.memo (SongsList);\r\n","import React, { useState, useEffect, useRef, useCallback } from \"react\";\r\nimport { CSSTransition } from \"react-transition-group\";\r\nimport { Container } from \"./style\";\r\nimport { HEADER_HEIGHT } from \"./../../api/config\";\r\nimport { ImgWrapper, CollectButton, SongListWrapper, BgLayer } from \"./style\";\r\nimport Header from \"../../baseUI/header/index\";\r\nimport Scroll from \"../../baseUI/scroll/index\";\r\nimport SongsList from \"../SongsList\";\r\nimport { connect } from 'react-redux';\r\nimport Loading from \"./../../baseUI/loading/index\";\r\nimport { getSingerInfo, changeEnterLoading } from \"./store/actionCreators\";\r\n\r\nfunction Singer(props) {\r\n  const initialHeight = useRef(0);\r\n  const [showStatus, setShowStatus] = useState(true);\r\n\r\n  const { \r\n    artist: immutableArtist, \r\n    songs: immutableSongs, \r\n    loading,\r\n  } = props;\r\n  \r\n  const { getSingerDataDispatch } = props;\r\n  \r\n  const artist = immutableArtist.toJS();\r\n  const songs = immutableSongs.toJS();\r\n\r\n  const collectButton = useRef();\r\n  const imageWrapper = useRef();\r\n  const songScrollWrapper = useRef();\r\n  const songScroll = useRef();\r\n  const header = useRef();\r\n  const layer = useRef();\r\n\r\n  //往上偏移的尺寸，露出圆角\r\n  const OFFSET = 5;\r\n\r\n  useEffect(() => {\r\n    const id = props.match.params.id;\r\n    getSingerDataDispatch(id);\r\n    let h = imageWrapper.current.offsetHeight;\r\n    initialHeight.current = h;\r\n    songScrollWrapper.current.style.top = `${h - OFFSET}px`;\r\n    //把遮罩先放在下面，以裹住歌曲列表\r\n    layer.current.style.top = `${h - OFFSET}px`;\r\n    songScroll.current.refresh();\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  const handleScroll = useCallback(pos => {\r\n    let height = initialHeight.current;\r\n    const newY = pos.y;\r\n    const imageDOM = imageWrapper.current;\r\n    const buttonDOM = collectButton.current;\r\n    const headerDOM = header.current;\r\n    const layerDOM = layer.current;\r\n    const minScrollY = -(height - OFFSET) + HEADER_HEIGHT;\r\n\r\n    //指的是滑动距离占图片高度的百分比\r\n    const percent = Math.abs(newY / height);\r\n\r\n    if (newY > 0) {\r\n      imageDOM.style[\"transform\"] = `scale(${1 + percent})`;\r\n      buttonDOM.style[\"transform\"] = `translate3d(0, ${newY}px, 0)`;\r\n      layerDOM.style.top = `${height - OFFSET + newY}px`;\r\n    } else if (newY >= minScrollY) {\r\n      layerDOM.style.top = `${height - OFFSET - Math.abs(newY)}px`;\r\n      //这时候保证遮罩的层叠优先级比图片高，不至于被图片挡住\r\n      layerDOM.style.zIndex = 1;\r\n      imageDOM.style.paddingTop = \"75%\";\r\n      imageDOM.style.height = 0;\r\n      imageDOM.style.zIndex = -1;\r\n      //按钮跟着移动且渐渐变透明\r\n      buttonDOM.style[\"transform\"] = `translate3d(0, ${newY}px, 0)`;\r\n      buttonDOM.style[\"opacity\"] = `${1 - percent * 2}`;\r\n    } else if (newY < minScrollY) {\r\n      //往上滑动，但是超过Header部分\r\n      layerDOM.style.top = `${HEADER_HEIGHT - OFFSET}px`;\r\n      layerDOM.style.zIndex = 1;\r\n      //防止溢出的歌单内容遮住Header\r\n      headerDOM.style.zIndex = 100;\r\n      //此时图片高度与Header一致\r\n      imageDOM.style.height = `${HEADER_HEIGHT}px`;\r\n      imageDOM.style.paddingTop = 0;\r\n      imageDOM.style.zIndex = 99;\r\n    }\r\n  }, [])\r\n\r\n  const setShowStatusFalse = useCallback(() => {\r\n    setShowStatus(false);\r\n  }, []);\r\n\r\n  return (\r\n    <CSSTransition\r\n      in={showStatus}\r\n      timeout={300}\r\n      classNames=\"fly\"\r\n      appear={true}\r\n      unmountOnExit\r\n      onExited={() => props.history.goBack()}\r\n    >\r\n      <Container>\r\n        <Header\r\n          handleClick={setShowStatusFalse}\r\n          title={artist.name}\r\n          ref={header}\r\n        ></Header>\r\n        <ImgWrapper ref={imageWrapper} bgUrl={artist.picUrl}>\r\n          <div className=\"filter\"></div>\r\n        </ImgWrapper>\r\n        <CollectButton ref={collectButton}>\r\n          <i className=\"iconfont\">&#xe62d;</i>\r\n          <span className=\"text\">收藏</span>\r\n        </CollectButton>\r\n        <BgLayer ref={layer}></BgLayer>\r\n        <SongListWrapper ref={songScrollWrapper}>\r\n          <Scroll ref={songScroll} onScroll={handleScroll}>\r\n            <SongsList\r\n              songs={songs}\r\n              showCollect={false}\r\n            ></SongsList>\r\n          </Scroll>\r\n        </SongListWrapper>\r\n        { loading ? (<Loading></Loading>) : null}\r\n      </Container>\r\n    </CSSTransition>\r\n  )\r\n}\r\n\r\n// 映射Redux全局的state到组件的props上\r\nconst mapStateToProps = state => ({\r\n  artist: state.getIn([\"singerInfo\", \"artist\"]),\r\n  songs: state.getIn([\"singerInfo\", \"songsOfArtist\"]),\r\n  loading: state.getIn([\"singerInfo\", \"loading\"]),\r\n});\r\n// 映射dispatch到props上\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    getSingerDataDispatch(id) {\r\n      dispatch(changeEnterLoading(true));\r\n      dispatch(getSingerInfo(id));\r\n    }\r\n  };\r\n};\r\n\r\n// 将ui组件包装成容器组件\r\nexport default connect(mapStateToProps,mapDispatchToProps)(React.memo(Singer));\r\n","import {RankTypes} from './config';\r\n\r\nexport const getCount = count => {\r\n  if (count < 0) return;\r\n  if (count < 10000) {\r\n    return count;\r\n  } else if (Math.floor (count / 10000) < 10000) {\r\n    return Math.floor (count / 1000) / 10 + '万';\r\n  } else {\r\n    return Math.floor (count / 10000000) / 10 + '亿';\r\n  }\r\n};\r\n\r\nexport const debounce = (func, delay) => {\r\n  let timer;\r\n  return function (...args) {\r\n    if (timer) {\r\n      clearTimeout (timer);\r\n    }\r\n    timer = setTimeout (() => {\r\n      func.apply (this, args);\r\n      clearTimeout (timer);\r\n    }, delay);\r\n  };\r\n};\r\n\r\n// 处理数据，找出第一个没有歌名的排行榜的索引\r\nexport const filterIndex = rankList => {\r\n  for (let i = 0; i < rankList.length - 1; i++) {\r\n    if (rankList[i].tracks.length && !rankList[i + 1].tracks.length) {\r\n      return i + 1;\r\n    }\r\n  }\r\n};\r\n\r\n//找出排行榜的编号\r\nexport const filterIdx = name => {\r\n  for (var key in RankTypes) {\r\n    if (RankTypes[key] === name) return key;\r\n  }\r\n  return null;\r\n};\r\n\r\n// 处理歌手列表拼接歌手名字\r\nexport const getName = list => {\r\n  let str = '';\r\n  list.map ((item, index) => {\r\n    str += index === 0 ? item.name : '/' + item.name;\r\n    return item;\r\n  });\r\n  return str;\r\n};\r\n\r\n//判断一个对象是否为空\r\nexport const isEmptyObject = obj => !obj || Object.keys (obj).length === 0;\r\n","import React from 'react';\r\nimport styled, {keyframes} from 'styled-components';\r\nimport style from '../../assets/global-style';\r\nimport {PropTypes} from 'prop-types';\r\n\r\nconst loading = keyframes`\r\n  0%, 100% {\r\n    transform: scale(0.0);\r\n  }\r\n  50% {\r\n    transform: scale(1.0);\r\n  }\r\n`;\r\nconst LoadingWrapper = styled.div`\r\n  >div {\r\n    position: absolute;\r\n    left: 0; \r\n    right: 0;  \r\n    top: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    width: 60px;\r\n    height: 60px;\r\n    opacity: 0.6;\r\n    border-radius: 50%;\r\n    background-color: ${style['theme-color']};\r\n    animation: ${loading} 1.4s infinite ease-in;\r\n  }\r\n  >div:nth-child(2) {\r\n    animation-delay: -0.7s;\r\n  }\r\n`;\r\n\r\nfunction Loading (props) {\r\n  const {show} = props;\r\n  return (\r\n    <LoadingWrapper style={show ? {display: ''} : {display: 'none'}}>\r\n      <div />\r\n      <div />\r\n    </LoadingWrapper>\r\n  );\r\n}\r\n\r\nLoading.defaultProps = {\r\n  show: true,\r\n};\r\n\r\nLoading.propTypes = {\r\n  show: PropTypes.bool,\r\n};\r\n\r\nexport default React.memo (Loading);\r\n","import React from 'react';\r\nimport styled, {keyframes} from 'styled-components';\r\nimport style from '../../assets/global-style';\r\n\r\nconst dance = keyframes`\r\n    0%, 40%, 100%{\r\n      transform: scaleY(0.4);\r\n      transform-origin: center 100%;\r\n    }\r\n    20%{\r\n      transform: scaleY(1);\r\n    }\r\n`;\r\nconst Loading = styled.div`\r\n    height: 10px;\r\n    width: 100%;\r\n    margin: auto;\r\n    text-align: center;\r\n    font-size: 10px;\r\n    >div{\r\n      display: inline-block;\r\n      background-color: ${style['theme-color']};\r\n      height: 100%;\r\n      width: 1px;\r\n      margin-right:2px;\r\n      animation: ${dance} 1s infinite;\r\n    }\r\n    >div:nth-child(2) {\r\n      animation-delay: -0.4s;\r\n    }\r\n    >div:nth-child(3) {\r\n      animation-delay: -0.6s;\r\n    }\r\n    >div:nth-child(4) {\r\n      animation-delay: -0.5s;\r\n    }\r\n    >div:nth-child(5) {\r\n      animation-delay: -0.2s;\r\n    } \r\n`;\r\n\r\nfunction LoadingV2 () {\r\n  return (\r\n    <Loading>\r\n      <div />\r\n      <div />\r\n      <div />\r\n      <div />\r\n      <div />\r\n      <span>拼命加载中...</span>\r\n    </Loading>\r\n  );\r\n}\r\n\r\nexport default React.memo (LoadingV2);\r\n","import React, {\r\n  forwardRef,\r\n  useState,\r\n  useEffect,\r\n  useRef,\r\n  useImperativeHandle,\r\n  useMemo,\r\n} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport BScroll from 'better-scroll';\r\nimport styled from 'styled-components';\r\nimport Loading from '../loading';\r\nimport {debounce} from '../../api/utils';\r\nimport LoadingV2 from '../loading-v2';\r\n\r\nconst ScrollContainer = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst PullUpLoading = styled.div`\r\n  position: absolute;\r\n  left:0; right:0;\r\n  bottom: 5px;\r\n  width: 60px;\r\n  height: 60px;\r\n  margin: auto;\r\n  z-index: 100;\r\n`;\r\n\r\nexport const PullDownLoading = styled.div`\r\n  position: absolute;\r\n  left:0; right:0;\r\n  top: 0px;\r\n  height: 30px;\r\n  margin: auto;\r\n  z-index: 100;\r\n`;\r\n\r\nconst Scroll = forwardRef ((props, ref) => {\r\n  const [bScroll, setBScroll] = useState ();\r\n\r\n  const scrollContaninerRef = useRef ();\r\n\r\n  const {direction, click, refresh, bounceTop, bounceBottom} = props;\r\n\r\n  const {pullUp, pullDown, onScroll, pullUpLoading, pullDownLoading} = props;\r\n\r\n  let pullUpDebounce = useMemo (\r\n    () => {\r\n      return debounce (pullUp, 300);\r\n    },\r\n    [pullUp]\r\n  );\r\n\r\n  let pullDownDebounce = useMemo (\r\n    () => {\r\n      return debounce (pullDown, 300);\r\n    },\r\n    [pullDown]\r\n  );\r\n\r\n  useEffect (() => {\r\n    const scroll = new BScroll (scrollContaninerRef.current, {\r\n      scrollX: direction === 'horizental',\r\n      scrollY: direction === 'vertical',\r\n      probeType: 3,\r\n      click: click,\r\n      bounce: {\r\n        top: bounceTop,\r\n        bottom: bounceBottom,\r\n      },\r\n    });\r\n    setBScroll (scroll);\r\n    return () => {\r\n      setBScroll (null);\r\n    };\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect (\r\n    () => {\r\n      if (!bScroll || !onScroll) return;\r\n      bScroll.on ('scroll', scroll => {\r\n        onScroll (scroll);\r\n      });\r\n      return () => {\r\n        bScroll.off ('scroll');\r\n      };\r\n    },\r\n    [onScroll, bScroll]\r\n  );\r\n\r\n  useEffect (\r\n    () => {\r\n      if (!bScroll || !pullUp) return;\r\n      bScroll.on ('scrollEnd', () => {\r\n        //判断是否滑动到了底部\r\n        if (bScroll.y <= bScroll.maxScrollY + 100) {\r\n          pullUpDebounce ();\r\n        }\r\n      });\r\n      return () => {\r\n        bScroll.off ('scrollEnd');\r\n      };\r\n    },\r\n    [pullUpDebounce, pullUp, bScroll]\r\n  );\r\n\r\n  useEffect (\r\n    () => {\r\n      if (!bScroll || !pullDown) return;\r\n      bScroll.on ('touchEnd', pos => {\r\n        //判断用户的下拉动作\r\n        if (pos.y > 50) {\r\n          pullDownDebounce ();\r\n        }\r\n      });\r\n      return () => {\r\n        bScroll.off ('touchEnd');\r\n      };\r\n    },\r\n    [pullDownDebounce, pullDown, bScroll]\r\n  );\r\n\r\n  useEffect (() => {\r\n    if (refresh && bScroll) {\r\n      bScroll.refresh ();\r\n    }\r\n  });\r\n\r\n  useImperativeHandle (ref, () => ({\r\n    refresh () {\r\n      if (bScroll) {\r\n        bScroll.refresh ();\r\n        bScroll.scrollTo (0, 0);\r\n      }\r\n    },\r\n    getBScroll () {\r\n      if (bScroll) {\r\n        return bScroll;\r\n      }\r\n    },\r\n  }));\r\n\r\n  const PullUpdisplayStyle = pullUpLoading ? {display: ''} : {display: 'none'};\r\n  const PullDowndisplayStyle = pullDownLoading ? {display: ''} : {display: 'none'};\r\n  return (\r\n    <ScrollContainer ref={scrollContaninerRef}>\r\n      {props.children}\r\n      {/* 滑到底部加载动画 */}\r\n      <PullUpLoading style={PullUpdisplayStyle}><Loading /></PullUpLoading>\r\n      {/* 顶部下拉刷新动画 */}\r\n      <PullDownLoading style={PullDowndisplayStyle}>\r\n        <LoadingV2 />\r\n      </PullDownLoading>\r\n    </ScrollContainer>\r\n  );\r\n});\r\n\r\nScroll.defaultProps = {\r\n  direction: 'vertical',\r\n  click: true,\r\n  refresh: true,\r\n  onScroll: null,\r\n  pullUpLoading: false,\r\n  pullDownLoading: false,\r\n  pullUp: null,\r\n  pullDown: null,\r\n  bounceTop: true,\r\n  bounceBottom: true,\r\n};\r\n\r\nScroll.propTypes = {\r\n  direction: PropTypes.oneOf (['vertical', 'horizental']),\r\n  refresh: PropTypes.bool,\r\n  onScroll: PropTypes.func,\r\n  pullUp: PropTypes.func,\r\n  pullDown: PropTypes.func,\r\n  pullUpLoading: PropTypes.bool,\r\n  pullDownLoading: PropTypes.bool,\r\n  bounceTop: PropTypes.bool, //是否支持向上吸顶\r\n  bounceBottom: PropTypes.bool, //是否支持向上吸顶\r\n};\r\n\r\nexport default Scroll;\r\n"],"sourceRoot":""}